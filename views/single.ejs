<%- include('partials/header') %>

<div class="flex flex-col lg:flex-row gap-8 pb-12">
  <div class="w-full lg:w-[70%]">
    <nav class="flex text-sm text-gray-400 mb-4" aria-label="Breadcrumb">
      <ol class="inline-flex items-center space-x-1 md:space-x-2">
        <li class="inline-flex items-center">
          <a href="/" class="hover:text-pink-500 transition-colors">Home</a>
        </li>
        <li>
          <span class="text-gray-600 mx-2">/</span>
        </li>
        <li class="truncate max-w-[200px] md:max-w-md text-gray-200">
          <span class="text-gray-500">Video</span>
          <span class="text-gray-600 mx-2">/</span>
          <%= video.title %>
        </li>
      </ol>
    </nav>

    <div class="relative w-full bg-black rounded-xl shadow-[0_10px_40px_-10px_rgba(0,0,0,0.5)] overflow-hidden border border-gray-800 ring-1 ring-white/10">
      <div class="aspect-video w-full relative">
        <iframe src="<%= embed_url_full %>" class="absolute top-0 left-0 w-full h-full" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen title="<%= video.title %>"></iframe>
      </div>
    </div>

    <div class="mt-6 border-b border-gray-800 pb-6">
      <h1 class="text-xl md:text-2xl lg:text-3xl font-black text-white leading-tight mb-4 tracking-tight">
        <%= video.title %>
      </h1>

      <div class="flex flex-wrap items-center gap-3 text-xs font-medium text-gray-400">
        <div class="flex items-center gap-1.5 bg-gray-900 border border-gray-700 px-3 py-1.5 rounded-full">
          <svg class="w-4 h-4 text-pink-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
          </svg>
          <span><%= video.views.toLocaleString() %> x Ditonton</span>
        </div>

        <div class="flex items-center gap-1.5 bg-gray-900 border border-gray-700 px-3 py-1.5 rounded-full">
          <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          <span><%= new Date(video.upload_date).toLocaleDateString('id-ID', {
            day: 'numeric', month: 'long', year: 'numeric'
          }) %></span>
        </div>

        <div class="flex items-center gap-1.5 bg-gray-900 border border-gray-700 px-3 py-1.5 rounded-full">
          <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span><%= formatDuration(video.duration_sec) %></span>
        </div>
      </div>
    </div>

    <!-- Categories -->
    <% if (video.categories && video.categories.length > 0) {
      %>
      <div class="mb-4">
        <h3 class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-2">Kategori:</h3>
        <div class="flex flex-wrap gap-2">
          <% video.categories.forEach(cat => {
            %>
            <a href="/category/<%= cat.toLowerCase().trim().replace(/ /g, '-') %>"
              class="group bg-blue-900/20 hover:bg-blue-600 text-blue-300 hover:text-white text-xs font-medium px-3 py-1.5 rounded-full transition-all border border-blue-900 hover:border-blue-500 flex items-center gap-1">
              <span>ðŸ“‚</span> <%= cat %>
            </a>
            <%
          }) %>
        </div>
      </div>
      <%
    } %>

    <!-- Tags -->
    <% if (video.tags && video.tags.length > 0) {
      %>
      <div class="mb-6">
        <h3 class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-2">Tags:</h3>
        <div class="flex flex-wrap gap-2">
          <% video.tags.forEach(tag => {
            %>
            <a href="/tag/<%= tag.toLowerCase().trim().replace(/ /g, '-') %>"
              class="group  hover:bg-pink-600 text-gray-300 hover:text-white text-xs font-medium px-3 py-1.5 rounded-full transition-all border border-gray-700 hover:border-pink-500">
              <span class="text-pink-500 group-hover:text-white mr-1">#</span><%= tag %>
            </a>
            <%
          }) %>
        </div>
      </div>
      <%
    } %>

<div class="mt-5 bg-gray-900/50 border border-gray-800 p-4 rounded-xl">
<h3 class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 flex items-center gap-2">
<span class="w-1.5 h-1.5 bg-pink-500 rounded-full"></span> Deskripsi Video
</h3>
<div class="text-gray-300 leading-snug text-sm whitespace-pre-wrap">
<%= typeof current_desc !=='undefined' ? current_desc : '' %>
</div>
</div>

    <!-- SEO Description Box -->
    <div class="mt-6 bg-gray-900/30 border border-gray-800 p-4 rounded-xl">
      <p class="text-gray-400 text-sm leading-relaxed">
        Nonton video <strong><%= video.title %></strong> dengan durasi <%= formatDuration(video.duration_sec) %>.
        <% if (video.categories && video.categories.length > 0) {
          %>
          Video ini termasuk dalam kategori: <%= video.categories.join(', ') %>.
          <%
        } %>
        Streaming video bokep terbaru dan terlengkap hanya di <%= site_name %>.
      </p>
    </div>
  </div>

  <!-- Sidebar -->
  <aside class="w-full lg:w-[30%]">
    <div class="lg:sticky lg:top-24 space-y-6">
      <div class="bg-gray-900/50 border border-gray-800 p-4 rounded-xl">
        <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
          <span class="text-pink-500">Video</span> Serupa
        </h3>

        <div class="space-y-3">
          <% related.forEach(rel => {
            %>
            <a href="/video/<%= rel.slug %>" class="flex gap-3 group bg-gray-900/30 hover:bg-gray-800 p-2 rounded-xl transition-all border border-transparent hover:border-gray-700">
              <div class="relative w-32 h-[4.5rem] flex-shrink-0 overflow-hidden rounded-lg bg-gray-800">
                <% if (rel.thumbnail) {
                  %>
                  <img src="<%= rel.thumbnail %>" class="w-full h-full object-cover group-hover:scale-110 transition duration-500" alt="<%= rel.title %>" loading="lazy">
                  <%
                } else {
                  %>
                  <div class="w-full h-full flex items-center justify-center text-[10px] text-gray-500">
                    No Image
                  </div>
                  <%
                } %>

                <div class="absolute bottom-1 right-1 bg-black/80 backdrop-blur-sm text-[9px] font-bold px-1.5 py-0.5 rounded text-white border border-white/10">
                  <%= formatDuration(rel.duration_sec) %>
                </div>
              </div>

              <div class="flex flex-col justify-center min-w-0">
                <h4 class="text-xs font-bold text-gray-200 group-hover:text-pink-400 line-clamp-2 leading-snug mb-1">
                  <%= rel.title %>
                </h4>
                <div class="flex items-center gap-2 text-[10px] text-gray-500">
                  <span><%= new Date(rel.upload_date).toLocaleDateString('id-ID', {
                    day: 'numeric', month: 'short'
                  }) %></span>
                  <span class="text-gray-600">â€¢</span>
                  <span><%= rel.views ? rel.views.toLocaleString(): 0 %> views</span>
                </div>
              </div>
            </a>
            <%
          }) %>
        </div>
      </div>
    </div>
  </aside>
</div>

<!-- Schema.org -->
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "VideoObject",
    "name": "<%= video.title %>",
    "description": "<%= video.description ? video.description.replace(/"/g,
      '\\"'): 'Nonton video ' + video.title %>",
    "thumbnailUrl": "<%= current_image %>",
    "uploadDate": "<%= new Date(video.upload_date).toISOString() %>",
    "duration": "<%= video.duration %>",
    "contentUrl": "<%= current_url %>",
    "embedUrl": "<%= embed_url_full %>",
    "interactionStatistic": {
      "@type": "InteractionCounter",
      "interactionType": "https://schema.org/WatchAction",
      "userInteractionCount": <%= video.views %>
    },
    "author": {
      "@type": "Organization",
      "name": "<%= site_name %>"
    }
  }
</script>

<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "<%= site_url %>"
    },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "<%= video.title %>",
        "item": "<%= current_url %>"
      }]
  }
</script>

<%- include('partials/footer') %>